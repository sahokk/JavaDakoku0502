package settings;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

import db_control.DbLoginInfo;

public class RunOnce {

	private String colmunsName;
	private String tableName;

	private static Connection sqlCon = null;
	private PreparedStatement sqlStmt = null;
	private ResultSet res = null;

	private static final String USER = DbLoginInfo.ROOT_USER.getValue();
	private static final String PASSWORD = DbLoginInfo.ROOT_PASSWORD.getValue();
	private static final String URL = DbLoginInfo.ROOT_URL.getValue();

	private static boolean isFirst = true;

	public RunOnce() {
		this.colmunsName = "";
	}

	private static void connectDB() {
		try {
			sqlCon = DriverManager.getConnection(URL, USER, PASSWORD);
			System.out.println("DB connect success");
		} catch (SQLException e) {
			e.printStackTrace();
		}
	}

	private static void closeDB(ResultSet res, PreparedStatement stmt, Connection con) {
		try {
			if (res != null) {
				res.close();
			}
			if (stmt != null) {
				stmt.close();
			}
			if (con != null) {
				con.close();
			}
		} catch (SQLException e) {
			e.printStackTrace();
		}
	}

	private boolean checkFirst() {
		connectDB();
		try {
			sqlStmt = sqlCon.prepareStatement("show databases;");
			res = sqlStmt.executeQuery();
			while (res.next()) {
				if (res.getString("Databases").equals(DbLoginInfo.GIKEN_DB_NAME.getValue())) {
					return false;
				}

			}
		} catch (SQLException e) {
			// TODO: handle exception
		}

		return true;
	}

}
