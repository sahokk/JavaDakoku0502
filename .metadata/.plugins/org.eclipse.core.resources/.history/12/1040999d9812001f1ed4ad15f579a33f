package web_control;

import java.io.BufferedReader;
import java.io.InputStream;
import java.io.InputStreamReader;

import org.openqa.selenium.WebDriver;
import org.openqa.selenium.chrome.ChromeDriver;
import org.openqa.selenium.chrome.ChromeOptions;

public abstract class WebControl {
	private WebDriver driver;
	private String pageUrl;
	private boolean flagLogin;
	private static ChromeOptions chromeOptions = new ChromeOptions();

	protected WebControl() {
		InputStream stream = this.getClass().getClassLoader().getResourceAsStream("./chromedriver.exe");
		String pathString =  new BufferedReader(new InputStreamReader(stream)).readLine();
		System.setProperty("webdriver.chrome.driver", pathString);
		chromeOptions.addArguments("--headless");
		this.driver = new ChromeDriver(chromeOptions);
		this.flagLogin = false;
	}

	public WebDriver getDriver() {
		return driver;
	}

	protected void setDriver(WebDriver driver) {
		this.driver = driver;
	}

	public String getPageUrl() {
		return pageUrl;
	}

	protected void setPageUrl(String pageUrl) {
		this.pageUrl = pageUrl;
	}

	protected void accessLoginPage() {
		if (!flagLogin) {
			driver.get(pageUrl);
		}
	}

	public void finishDriver() {
		driver.close();
	}

	public void toggleFlagLogin(String currentUrl) {
		this.flagLogin = currentUrl.contains("Login") ? false : !currentUrl.contains("Logout");
		System.out.println("ログイン状態: " + flagLogin);
		System.out.println("==============");
	}

	public boolean isFlagLogin() {
		return flagLogin;
	}

}
